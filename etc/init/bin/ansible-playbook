#!/bin/bash -e

ANSIBLE_HOME="${ANSIBLE_HOME:-./tmp/ansible}"
ANSIBLE_VERSION="${ANSIBLE_VERSION:-2.7.8}"

ANSIBLE_LIB_PATH="${ANSIBLE_HOME}/${ANSIBLE_VERSION}"

ANSIBLE_PLAYBOOK_BIN="${ANSIBLE_LIB_PATH}/bin/ansible-playbook"

if [ ! -e "${ANSIBLE_LIB_PATH}" ]; then
  mkdir -p ${ANSIBLE_LIB_PATH}
  pip install -t ${ANSIBLE_LIB_PATH} ansible==${ANSIBLE_VERSION}
fi

PYTHONPATH="${ANSIBLE_LIB_PATH}" ${ANSIBLE_PLAYBOOK_BIN} $@
